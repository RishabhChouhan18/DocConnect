<%- include('../../partials/header', {title: 'Patient Home'}) %>

<main class="main-content">
  <div class="hero-section">
    <div class="hero-content">
      <h1><i class="fas fa-heart-pulse"></i> Welcome to DocConnect+</h1>
      <p class="hero-subtitle">Book appointments with qualified doctors near you</p>

      <div class="hero-features">
        <div class="feature">
          <i class="fas fa-search"></i>
          <h3>Find Doctors</h3>
          <p>Search by location and specialization</p>
        </div>
        <div class="feature">
          <i class="fas fa-calendar-check"></i>
          <h3>Easy Booking</h3>
          <p>Book appointments in just a few clicks</p>
        </div>
        <div class="feature">
          <i class="fas fa-robot"></i>
          <h3>AI Assistant</h3>
          <p>Get doctor suggestions based on symptoms</p>
        </div>
      </div>

      <div class="hero-buttons" style="display:flex;gap:.5rem;flex-wrap:wrap;justify-content:center;margin-top:1rem">
         <a href="/doctor/dashboard" class="btn btn-primary">
    <i class="fas fa-search"></i> Show My Patients
</a>

        <a href="/patient/doctors" class="btn btn-primary"><i class="fas fa-search"></i> Find Doctors</a>
        <a href="/chatbot" class="btn btn-secondary"><i class="fas fa-comments"></i> Ask Chatbot</a>
      </div>
    </div>
  </div>

  <section class="stats-section">
    <div class="stats-container">
      <div class="stat-item"><i class="fas fa-user-md"></i><h3>50+</h3><p>Qualified Doctors</p></div>
      <div class="stat-item"><i class="fas fa-calendar-check"></i><h3>1000+</h3><p>Appointments Booked</p></div>
      <div class="stat-item"><i class="fas fa-clock"></i><h3>24/7</h3><p>Support Available</p></div>
      <div class="stat-item"><i class="fas fa-star"></i><h3>4.9</h3><p>Average Rating</p></div>
    </div>
  </section>
</main>

<!-- AUTH MODAL (kept for future use; no open triggers on this page) -->
<div id="authModal" class="auth-backdrop" aria-hidden="true">
  <div class="auth-modal" role="dialog" aria-modal="true" aria-labelledby="authTitle">
    <div class="auth-header">
      <h3 id="authTitle"><i class="fas fa-sign-in-alt"></i> Login</h3>
      <button type="button" class="icon-btn" id="closeAuth"><i class="fas fa-times"></i></button>
    </div>

    <!-- VIEW: LOGIN (two sections) -->
    <div id="viewLogin" class="forms visible">
      <div class="login-grid">
        <!-- Patient Login -->
        <form class="form card" method="POST" action="/auth/login">
          <h4><i class="fas fa-user"></i> Patient Login</h4>
          <input type="hidden" name="role" value="patient">
          <div class="field"><label>Email</label><input type="email" name="email" required></div>
          <div class="field"><label>Password</label><input type="password" name="password" minlength="6" required></div>
          <button class="btn btn-primary w-100" type="submit">Login as Patient</button>
        </form>

        <!-- Doctor Login -->
        <form class="form card" method="POST" action="/auth/login">
          <h4><i class="fas fa-user-md"></i> Doctor Login</h4>
          <input type="hidden" name="role" value="doctor">
          <div class="field"><label>Email</label><input type="email" name="email" required></div>
          <div class="field"><label>Password</label><input type="password" name="password" minlength="6" required></div>
          <button class="btn btn-dark w-100" type="submit">Login as Doctor</button>
        </form>
      </div>

      <div class="divider">Don’t have an account?</div>
      <button class="btn btn-outline w-100" id="goSignup"><i class="fas fa-user-plus"></i> Create account</button>
    </div>

    <!-- VIEW: SIGNUP (single common form) -->
    <div id="viewSignup" class="forms">
      <form id="signupForm" class="form" method="POST" action="/auth/signup" novalidate>
        <div class="role-toggle" style="margin-top:-.25rem;margin-bottom:.5rem">
          <button type="button" class="role-btn active" data-role="patient">Patient</button>
          <button type="button" class="role-btn" data-role="doctor">Doctor</button>
        </div>

        <input type="hidden" name="role" id="signupRole" value="patient">

        <div class="grid-2">
          <div class="field"><label>Full name</label><input type="text" name="name" required></div>
          <div class="field"><label>Phone</label><input type="tel" name="phone" placeholder="9876543210" pattern="[0-9]{10}" required></div>
        </div>

        <div class="field doctor-only" style="display:none">
          <label>Specialization (Doctors)</label>
          <input type="text" name="specialization" placeholder="Cardiology / Dermatology …">
        </div>

        <div class="field"><label>Email</label><input type="email" name="email" required></div>

        <div class="grid-2">
          <div class="field"><label>Password</label><input type="password" name="password" minlength="6" required></div>
          <div class="field"><label>Confirm password</label><input type="password" name="confirm" minlength="6" required></div>
        </div>

        <button class="btn btn-primary w-100" type="submit">Create account</button>
      </form>

      <div class="divider">Already have an account?</div>
      <button class="btn btn-outline w-100" id="goLogin"><i class="fas fa-sign-in-alt"></i> Back to login</button>
    </div>
  </div>
</div>

<%- include('../../partials/footer') %>

<!-- Styles (move to your CSS file if you prefer) -->
<style>
  .btn{display:inline-flex;gap:.5rem;align-items:center;padding:.6rem 1rem;border-radius:10px;border:0;cursor:pointer;text-decoration:none}
  .btn-primary{background:#4f46e5;color:#fff}
  .btn-secondary{background:#6b7280;color:#fff}
  .btn-outline{background:#fff;border:1px solid #e5e7eb}
  .btn-dark{background:#111;color:#fff}
  .w-100{width:100%}

  /* Modal */
  .auth-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:1000}
  .auth-backdrop.show{display:flex;animation:fadeIn .2s ease-out}
  .auth-modal{width:min(640px,94vw);background:#fff;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.25);transform:translateY(12px) scale(.96);opacity:0;animation:popIn .22s ease-out forwards}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  @keyframes popIn{to{transform:translateY(0) scale(1);opacity:1}}
  .auth-header{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;border-bottom:1px solid #eee}
  .icon-btn{border:0;background:transparent;cursor:pointer;font-size:1.1rem}

  .forms{padding:1rem 1.25rem 1.25rem;display:none}
  .forms.visible{display:block}
  .form{display:block}
  .card{border:1px solid #e5e7eb;border-radius:14px;padding:1rem}
  .login-grid{display:grid;grid-template-columns:1fr;gap:.75rem}
  @media (min-width:700px){ .login-grid{grid-template-columns:1fr 1fr;} }

  .field{display:flex;flex-direction:column;gap:.35rem;margin:.5rem 0}
  .field input{padding:.65rem .75rem;border:1px solid #e5e7eb;border-radius:10px;outline:none}
  .field input:focus{border-color:#4f46e5;box-shadow:0 0 0 3px rgba(79,70,229,.15)}

  .role-toggle{display:flex;gap:.5rem;justify-content:center;padding:.5rem 0}
  .role-btn{border:1px solid #e5e7eb;background:#fff;border-radius:999px;padding:.35rem .9rem;cursor:pointer}
  .role-btn.active{background:#111;color:#fff;border-color:#111}

  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
  .divider{text-align:center;color:#666;margin:.8rem 0}
</style>

<!-- Modal Logic -->
<script>
  const modal = document.getElementById('authModal');
  const closeAuth = document.getElementById('closeAuth');

  const viewLogin = document.getElementById('viewLogin');
  const viewSignup = document.getElementById('viewSignup');
  const goSignup = document.getElementById('goSignup');
  const goLogin = document.getElementById('goLogin');

  const roleBtns = Array.from(document.querySelectorAll('#viewSignup .role-btn'));
  const signupRole = document.getElementById('signupRole');
  const doctorOnly = document.querySelector('#viewSignup .doctor-only');
  const title = document.getElementById('authTitle');

  // Open/close helpers (no auto-open from this page)
  function closeModal(){ modal.classList.remove('show'); }
  function showLogin(){
    title.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
    viewLogin.classList.add('visible');
    viewSignup.classList.remove('visible');
  }
  function showSignup(){
    title.innerHTML = '<i class="fas fa-user-plus"></i> Sign up';
    viewSignup.classList.add('visible');
    viewLogin.classList.remove('visible');
  }

  // Close handlers
  closeAuth?.addEventListener('click', closeModal);
  modal?.addEventListener('click', e => { if (e.target === modal) closeModal(); });
  window.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

  // Signup role toggle
  function setSignupRole(role){
    roleBtns.forEach(b => b.classList.toggle('active', b.dataset.role === role));
    signupRole.value = role;
    doctorOnly.style.display = role === 'doctor' ? '' : 'none';
  }
  roleBtns.forEach(b => b.addEventListener('click', () => setSignupRole(b.dataset.role)));
  setSignupRole('patient');

  // View switch buttons
  goSignup?.addEventListener('click', showSignup);
  goLogin?.addEventListener('click', showLogin);
</script>
